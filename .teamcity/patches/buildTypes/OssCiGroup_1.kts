package patches.buildTypes

import jetbrains.buildServer.configs.kotlin.v2019_2.*
import jetbrains.buildServer.configs.kotlin.v2019_2.buildSteps.script
import jetbrains.buildServer.configs.kotlin.v2019_2.ui.*

/*
This patch script was generated by TeamCity on settings change in UI.
To apply the patch, change the buildType with id = 'OssCiGroup_1'
accordingly, and delete the patch script.
*/
changeBuildType(RelativeId("OssCiGroup_1")) {
    expectSteps {
        script {
            scriptContent = """
                #!/bin/bash
                
                if [[ -d "/home/agent/.kibana/node_modules" ]]; then
                  echo 'Using node_modules cache'
                  mv /home/agent/.kibana/node_modules .
                fi
                
                export CI_PARALLEL_PROCESS_NUMBER=1
                export CI_GROUP=1
                export JOB=kibana-ciGroup1
                export CI=true
                export GCS_UPLOAD_PREFIX=ehwihsihfiashdhfshfso
                
                mv /home/agent/work/kibana-build-oss/kibana-8.0.0-SNAPSHOT-linux-x86_64/* /home/agent/work/kibana-build-oss/
                
                source ./src/dev/ci_setup/setup.sh
                ./test/scripts/jenkins_ci_group.sh
            """.trimIndent()
        }
    }
    steps {
        insert(1) {
            script {
                name = "test"
                scriptContent = "echo 1"
            }
        }
    }
}
